
**Note** : The only difference from the easy version is the constraints

# WARNING
Huge I/O. Use the template to avoid **TLE**.

# Modified Constraints
* $ 1 \leq n \leq 2*10^6
* All other constraints are as stated in the SS.
